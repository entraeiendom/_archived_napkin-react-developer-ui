{"ast":null,"code":"import _objectSpread from \"/src/entra/ex-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/src/entra/ex-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/src/entra/ex-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport auth0 from 'auth0-js';\nimport * as constant from './Constants';\n\nvar Auth = /*#__PURE__*/function () {\n  function Auth() {\n    _classCallCheck(this, Auth);\n\n    this.request = function (options) {\n      var headers = new Headers({\n        'Content-Type': 'application/json'\n      });\n\n      if (localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n        headers.append('Authorization', 'Bearer ' + localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN));\n      }\n\n      var defaults = {\n        headers: headers\n      };\n      options = Object.assign({}, defaults, options);\n      return fetch(options.url, options).then(function (response) {\n        return response.json().then(function (json) {\n          if (!response.ok) {\n            return Promise.reject(json);\n          }\n\n          return json;\n        });\n      });\n    };\n\n    this.auth0 = new auth0.WebAuth({\n      // the following three lines MUST be updated\n      domain: constant.OAUTH_DOMAIN,\n      clientID: constant.OAUTH_CLIENT_ID,\n      redirectUri: constant.OAUTH_REDIRECT_URI,\n      scope: constant.OAUTH_SCOPE,\n      responseType: 'code'\n    });\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.getProfile = this.getProfile.bind(this);\n    this.requestToken = this.requestToken.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.signIn = this.signIn.bind(this);\n    this.signOut = this.signOut.bind(this);\n  }\n\n  _createClass(Auth, [{\n    key: \"getProfile\",\n    value: function getProfile() {\n      if (!this.access_token && localStorage.getItem(constant.LOCALSTORAGE_ID_TOKEN)) {\n        var id_token_payload = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ID_TOKEN));\n        this.profile = _objectSpread({}, id_token_payload, {\n          'name': \"\".concat(id_token_payload.first_name, \" \").concat(id_token_payload.last_name)\n        });\n      }\n\n      return this.profile;\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function getAccessToken() {\n      if (!this.access_token && localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n        this.access_token = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN));\n      }\n\n      return this.access_token;\n    }\n  }, {\n    key: \"isAuthenticated\",\n    value: function isAuthenticated() {\n      if (!this.expiresAt && localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n        var access_token_payload = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN));\n        this.expiresAt = access_token_payload.exp * 1000;\n      }\n\n      return new Date().getTime() < this.expiresAt;\n    }\n  }, {\n    key: \"signIn\",\n    value: function signIn() {\n      this.auth0.authorize();\n    }\n  }, {\n    key: \"parseJwt\",\n    value: function parseJwt(token) {\n      var base64Payload = token.split('.')[1];\n      var payload = Buffer.from(base64Payload, 'base64');\n      return JSON.parse(payload);\n    }\n  }, {\n    key: \"refreshToken\",\n    value: function refreshToken(refresh_token) {\n      var _this = this;\n\n      var base64Credentials = Buffer.from(constant.OAUTH_CLIENT_ID + ':' + 'optional').toString('base64');\n      return new Promise(function (resolve, reject) {\n        _this.request({\n          url: \"https://\".concat(constant.OAUTH_DOMAIN, \"/token?grant_type=refresh_token&refresh_token=\").concat(refresh_token),\n          method: 'POST',\n          headers: {\n            'Authorization': 'Basic ' + base64Credentials,\n            'Content-Type': 'application/x-www-form-urlencoded'\n          }\n        }).then(function (response) {\n          _this.setSession(response);\n\n          resolve();\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"requestToken\",\n    value: function requestToken(authorization_code) {\n      var _this2 = this;\n\n      var base64Credentials = Buffer.from(constant.OAUTH_CLIENT_ID + ':' + 'optional').toString('base64');\n      return new Promise(function (resolve, reject) {\n        _this2.request({\n          url: \"https://\".concat(constant.OAUTH_DOMAIN, \"/token?grant_type=authorization_code&code=\").concat(authorization_code),\n          method: 'POST',\n          headers: {\n            'Authorization': 'Basic ' + base64Credentials,\n            'Content-Type': 'application/x-www-form-urlencoded'\n          }\n        }).then(function (response) {\n          _this2.setSession(response);\n\n          resolve(response);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"setSession\",\n    value: function setSession(response) {\n      var access_token_payload = this.parseJwt(response.access_token);\n      var id_token_payload = this.parseJwt(response.id_token);\n      this.access_token = response.access_token;\n      this.expiresAt = access_token_payload.exp * 1000;\n      this.profile = _objectSpread({}, id_token_payload, {\n        'name': \"\".concat(id_token_payload.first_name, \" \").concat(id_token_payload.last_name)\n      });\n      localStorage.setItem(constant.LOCALSTORAGE_ACCESS_TOKEN, response.access_token);\n      localStorage.setItem(constant.LOCALSTORAGE_REFRESH_TOKEN, response.refresh_token);\n      localStorage.setItem(constant.LOCALSTORAGE_ID_TOKEN, response.id_token);\n    }\n  }, {\n    key: \"signOut\",\n    value: function signOut() {\n      //log out SSO\n      fetch(\"https://\".concat(constant.OAUTH_DOMAIN, \"/logout\"), {\n        method: 'GET'\n      });\n      localStorage.removeItem(constant.LOCALSTORAGE_ACCESS_TOKEN);\n      localStorage.removeItem(constant.LOCALSTORAGE_REFRESH_TOKEN);\n      localStorage.removeItem(constant.LOCALSTORAGE_ID_TOKEN);\n      this.expiresAt = 0;\n      this.profile = undefined;\n    }\n  }, {\n    key: \"validateAuth\",\n    value: function validateAuth() {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this3.expiresAt && new Date().getTime() < _this3.expiresAt - 30 * 1000) {\n          //30 seconds before it expires\n          resolve();\n        } else {\n          if (localStorage.getItem(constant.LOCALSTORAGE_REFRESH_TOKEN)) {\n            _this3.refreshToken(localStorage.getItem(constant.LOCALSTORAGE_REFRESH_TOKEN)).then(function (response) {\n              console.log('refresh_token called successfully');\n              resolve();\n            }).catch(function (error) {\n              reject(error);\n            });\n          } else {\n            reject({\n              error: 'login_required'\n            });\n          }\n        }\n      });\n    }\n  }]);\n\n  return Auth;\n}();\n\nvar auth0Client = new Auth();\nexport default auth0Client;","map":{"version":3,"sources":["/src/entra/ex-frontend/src/Auth.js"],"names":["auth0","constant","Auth","request","options","headers","Headers","localStorage","getItem","LOCALSTORAGE_ACCESS_TOKEN","append","defaults","Object","assign","fetch","url","then","response","json","ok","Promise","reject","WebAuth","domain","OAUTH_DOMAIN","clientID","OAUTH_CLIENT_ID","redirectUri","OAUTH_REDIRECT_URI","scope","OAUTH_SCOPE","responseType","getAccessToken","bind","getProfile","requestToken","isAuthenticated","signIn","signOut","access_token","LOCALSTORAGE_ID_TOKEN","id_token_payload","parseJwt","profile","first_name","last_name","expiresAt","access_token_payload","exp","Date","getTime","authorize","token","base64Payload","split","payload","Buffer","from","JSON","parse","refresh_token","base64Credentials","toString","resolve","method","setSession","catch","error","authorization_code","id_token","setItem","LOCALSTORAGE_REFRESH_TOKEN","removeItem","undefined","refreshToken","console","log","auth0Client"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AACA,OAAO,KAAKC,QAAZ,MAA0B,aAA1B;;IAGMC,I;AACJ,kBAAc;AAAA;;AAAA,SA6CdC,OA7Cc,GA6CJ,UAACC,OAAD,EAAa;AACrB,UAAMC,OAAO,GAAG,IAAIC,OAAJ,CAAY;AACxB,wBAAgB;AADQ,OAAZ,CAAhB;;AAIA,UAAGC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAAH,EAA6D;AACzDJ,QAAAA,OAAO,CAACK,MAAR,CAAe,eAAf,EAAgC,YAAYH,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAA5C;AACH;;AAED,UAAME,QAAQ,GAAG;AAACN,QAAAA,OAAO,EAAEA;AAAV,OAAjB;AACAD,MAAAA,OAAO,GAAGQ,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,QAAlB,EAA4BP,OAA5B,CAAV;AAEA,aAAOU,KAAK,CAACV,OAAO,CAACW,GAAT,EAAcX,OAAd,CAAL,CACNY,IADM,CACD,UAAAC,QAAQ;AAAA,eACVA,QAAQ,CAACC,IAAT,GAAgBF,IAAhB,CAAqB,UAAAE,IAAI,EAAI;AACzB,cAAG,CAACD,QAAQ,CAACE,EAAb,EAAiB;AACb,mBAAOC,OAAO,CAACC,MAAR,CAAeH,IAAf,CAAP;AACH;;AACD,iBAAOA,IAAP;AACH,SALD,CADU;AAAA,OADP,CAAP;AASH,KAlEe;;AACZ,SAAKlB,KAAL,GAAa,IAAIA,KAAK,CAACsB,OAAV,CAAkB;AAC7B;AACAC,MAAAA,MAAM,EAAEtB,QAAQ,CAACuB,YAFY;AAG7BC,MAAAA,QAAQ,EAAExB,QAAQ,CAACyB,eAHU;AAI7BC,MAAAA,WAAW,EAAE1B,QAAQ,CAAC2B,kBAJO;AAK7BC,MAAAA,KAAK,EAAE5B,QAAQ,CAAC6B,WALa;AAM7BC,MAAAA,YAAY,EAAE;AANe,KAAlB,CAAb;AASA,SAAKC,cAAL,GAAsB,KAAKA,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKC,UAAL,GAAkB,KAAKA,UAAL,CAAgBD,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKE,YAAL,GAAoB,KAAKA,YAAL,CAAkBF,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKG,eAAL,GAAuB,KAAKA,eAAL,CAAqBH,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKI,MAAL,GAAc,KAAKA,MAAL,CAAYJ,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKK,OAAL,GAAe,KAAKA,OAAL,CAAaL,IAAb,CAAkB,IAAlB,CAAf;AACD;;;;iCAEY;AACX,UAAG,CAAC,KAAKM,YAAN,IAAsBhC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACuC,qBAA9B,CAAzB,EAA+E;AAC7E,YAAIC,gBAAgB,GAAG,KAAKC,QAAL,CAAcnC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACuC,qBAA9B,CAAd,CAAvB;AACA,aAAKG,OAAL,qBAAmBF,gBAAnB;AAAqC,4BAAWA,gBAAgB,CAACG,UAA5B,cAA0CH,gBAAgB,CAACI,SAA3D;AAArC;AACD;;AACD,aAAO,KAAKF,OAAZ;AACD;;;qCAEgB;AACf,UAAG,CAAC,KAAKJ,YAAN,IAAsBhC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAAzB,EAAmF;AACjF,aAAK8B,YAAL,GAAoB,KAAKG,QAAL,CAAcnC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAAd,CAApB;AACD;;AACD,aAAO,KAAK8B,YAAZ;AACD;;;sCAEiB;AAChB,UAAG,CAAC,KAAKO,SAAN,IAAmBvC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAAtB,EAAgF;AAC9E,YAAIsC,oBAAoB,GAAG,KAAKL,QAAL,CAAcnC,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACQ,yBAA9B,CAAd,CAA3B;AACA,aAAKqC,SAAL,GAAiBC,oBAAoB,CAACC,GAArB,GAAyB,IAA1C;AACD;;AACD,aAAO,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,KAAKJ,SAAnC;AACD;;;6BAEQ;AACP,WAAK9C,KAAL,CAAWmD,SAAX;AACD;;;6BAyBMC,K,EAAO;AACd,UAAIC,aAAa,GAAGD,KAAK,CAACE,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAApB;AACA,UAAIC,OAAO,GAAGC,MAAM,CAACC,IAAP,CAAYJ,aAAZ,EAA2B,QAA3B,CAAd;AACA,aAAOK,IAAI,CAACC,KAAL,CAAWJ,OAAX,CAAP;AACD;;;iCAEYK,a,EAAe;AAAA;;AAE1B,UAAIC,iBAAiB,GAAGL,MAAM,CAACC,IAAP,CAAYxD,QAAQ,CAACyB,eAAT,GAA0B,GAA1B,GAAgC,UAA5C,EAAwDoC,QAAxD,CAAiE,QAAjE,CAAxB;AACA,aAAO,IAAI1C,OAAJ,CAAY,UAAC2C,OAAD,EAAU1C,MAAV,EAAqB;AACtC,QAAA,KAAI,CAAClB,OAAL,CAAa;AACXY,UAAAA,GAAG,oBAAad,QAAQ,CAACuB,YAAtB,2DAAmFoC,aAAnF,CADQ;AAEXI,UAAAA,MAAM,EAAE,MAFG;AAGX3D,UAAAA,OAAO,EAAE;AACP,6BAAiB,WAAWwD,iBADrB;AAEP,4BAAgB;AAFT;AAHE,SAAb,EAOG7C,IAPH,CAOQ,UAAAC,QAAQ,EAAI;AAChB,UAAA,KAAI,CAACgD,UAAL,CAAgBhD,QAAhB;;AACA8C,UAAAA,OAAO;AACZ,SAVC,EAUCG,KAVD,CAUO,UAAAC,KAAK,EAAI;AACZ,iBAAO9C,MAAM,CAAC8C,KAAD,CAAb;AACL,SAZC;AAYC,OAbI,CAAP;AAcD;;;iCAEYC,kB,EAAoB;AAAA;;AAE7B,UAAIP,iBAAiB,GAAGL,MAAM,CAACC,IAAP,CAAYxD,QAAQ,CAACyB,eAAT,GAA0B,GAA1B,GAAgC,UAA5C,EAAwDoC,QAAxD,CAAiE,QAAjE,CAAxB;AACA,aAAO,IAAI1C,OAAJ,CAAY,UAAC2C,OAAD,EAAU1C,MAAV,EAAqB;AACtC,QAAA,MAAI,CAAClB,OAAL,CAAa;AACXY,UAAAA,GAAG,oBAAad,QAAQ,CAACuB,YAAtB,uDAA+E4C,kBAA/E,CADQ;AAEXJ,UAAAA,MAAM,EAAE,MAFG;AAGX3D,UAAAA,OAAO,EAAE;AACP,6BAAiB,WAAWwD,iBADrB;AAEP,4BAAgB;AAFT;AAHE,SAAb,EAOG7C,IAPH,CAOQ,UAAAC,QAAQ,EAAI;AAChB,UAAA,MAAI,CAACgD,UAAL,CAAgBhD,QAAhB;;AACA8C,UAAAA,OAAO,CAAC9C,QAAD,CAAP;AACL,SAVC,EAUCiD,KAVD,CAUO,UAAAC,KAAK,EAAI;AACZ,iBAAO9C,MAAM,CAAC8C,KAAD,CAAb;AACL,SAZC;AAYC,OAbI,CAAP;AAcD;;;+BAEUlD,Q,EAAU;AACnB,UAAI8B,oBAAoB,GAAG,KAAKL,QAAL,CAAczB,QAAQ,CAACsB,YAAvB,CAA3B;AACA,UAAIE,gBAAgB,GAAG,KAAKC,QAAL,CAAczB,QAAQ,CAACoD,QAAvB,CAAvB;AAEA,WAAK9B,YAAL,GAAoBtB,QAAQ,CAACsB,YAA7B;AACA,WAAKO,SAAL,GAAiBC,oBAAoB,CAACC,GAArB,GAA2B,IAA5C;AACA,WAAKL,OAAL,qBAAoBF,gBAApB;AAAsC,0BAAWA,gBAAgB,CAACG,UAA5B,cAA0CH,gBAAgB,CAACI,SAA3D;AAAtC;AAEAtC,MAAAA,YAAY,CAAC+D,OAAb,CAAqBrE,QAAQ,CAACQ,yBAA9B,EAAyDQ,QAAQ,CAACsB,YAAlE;AACAhC,MAAAA,YAAY,CAAC+D,OAAb,CAAqBrE,QAAQ,CAACsE,0BAA9B,EAA0DtD,QAAQ,CAAC2C,aAAnE;AACArD,MAAAA,YAAY,CAAC+D,OAAb,CAAqBrE,QAAQ,CAACuC,qBAA9B,EAAqDvB,QAAQ,CAACoD,QAA9D;AACD;;;8BAES;AACR;AACAvD,MAAAA,KAAK,mBAAYb,QAAQ,CAACuB,YAArB,cAA4C;AAC/CwC,QAAAA,MAAM,EAAE;AADuC,OAA5C,CAAL;AAIAzD,MAAAA,YAAY,CAACiE,UAAb,CAAwBvE,QAAQ,CAACQ,yBAAjC;AACAF,MAAAA,YAAY,CAACiE,UAAb,CAAwBvE,QAAQ,CAACsE,0BAAjC;AACAhE,MAAAA,YAAY,CAACiE,UAAb,CAAwBvE,QAAQ,CAACuC,qBAAjC;AACA,WAAKM,SAAL,GAAiB,CAAjB;AACA,WAAKH,OAAL,GAAe8B,SAAf;AAED;;;mCAEc;AAAA;;AACb,aAAO,IAAIrD,OAAJ,CAAY,UAAC2C,OAAD,EAAU1C,MAAV,EAAqB;AACtC,YAAG,MAAI,CAACyB,SAAL,IAAkB,IAAIG,IAAJ,GAAWC,OAAX,KAAuB,MAAI,CAACJ,SAAL,GAAiB,KAAG,IAAhE,EAAsE;AAAE;AACtEiB,UAAAA,OAAO;AACR,SAFD,MAEO;AACL,cAAGxD,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACsE,0BAA9B,CAAH,EAA6D;AAC1D,YAAA,MAAI,CAACG,YAAL,CAAkBnE,YAAY,CAACC,OAAb,CAAqBP,QAAQ,CAACsE,0BAA9B,CAAlB,EAA6EvD,IAA7E,CAAkF,UAAAC,QAAQ,EAAI;AAC7F0D,cAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ;AACAb,cAAAA,OAAO;AACR,aAHA,EAGEG,KAHF,CAGQ,UAAAC,KAAK,EAAI;AAChB9C,cAAAA,MAAM,CAAC8C,KAAD,CAAN;AACD,aALA;AAMF,WAPD,MAOO;AACL9C,YAAAA,MAAM,CAAC;AAAC8C,cAAAA,KAAK,EAAE;AAAR,aAAD,CAAN;AACD;AACF;AACF,OAfM,CAAP;AAgBD;;;;;;AAGH,IAAMU,WAAW,GAAG,IAAI3E,IAAJ,EAApB;AAEA,eAAe2E,WAAf","sourcesContent":["import auth0 from 'auth0-js';\nimport * as constant from './Constants' \n\n\nclass Auth {\n  constructor() {\n    this.auth0 = new auth0.WebAuth({\n      // the following three lines MUST be updated\n      domain: constant.OAUTH_DOMAIN,\n      clientID: constant.OAUTH_CLIENT_ID,\n      redirectUri: constant.OAUTH_REDIRECT_URI,\n      scope: constant.OAUTH_SCOPE,\n      responseType: 'code'\n    });\n\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.getProfile = this.getProfile.bind(this);\n    this.requestToken = this.requestToken.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.signIn = this.signIn.bind(this);\n    this.signOut = this.signOut.bind(this);\n  }\n\n  getProfile() {\n    if(!this.access_token && localStorage.getItem(constant.LOCALSTORAGE_ID_TOKEN)) {\n      var id_token_payload = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ID_TOKEN))\n      this.profile = {...id_token_payload, 'name': `${id_token_payload.first_name} ${id_token_payload.last_name}`}\n    }\n    return this.profile;\n  }\n\n  getAccessToken() {\n    if(!this.access_token && localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n      this.access_token = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) \n    }\n    return this.access_token;\n  }\n\n  isAuthenticated() {\n    if(!this.expiresAt && localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n      var access_token_payload = this.parseJwt(localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN))\n      this.expiresAt = access_token_payload.exp*1000\n    }\n    return new Date().getTime() < this.expiresAt;\n  }\n\n  signIn() {\n    this.auth0.authorize();\n  }\n\n  request = (options) => {\n    const headers = new Headers({\n        'Content-Type': 'application/json',\n    })\n    \n    if(localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN)) {\n        headers.append('Authorization', 'Bearer ' + localStorage.getItem(constant.LOCALSTORAGE_ACCESS_TOKEN))\n    }\n\n    const defaults = {headers: headers};\n    options = Object.assign({}, defaults, options);\n\n    return fetch(options.url, options)\n    .then(response => \n        response.json().then(json => {\n            if(!response.ok) {\n                return Promise.reject(json);\n            }\n            return json;\n        })\n    );\n}\n\nparseJwt(token) {\n  var base64Payload = token.split('.')[1];\n  var payload = Buffer.from(base64Payload, 'base64');\n  return JSON.parse(payload);\n}\n\nrefreshToken(refresh_token) {\n  \n  let base64Credentials = Buffer.from(constant.OAUTH_CLIENT_ID+ ':' + 'optional').toString('base64');\n  return new Promise((resolve, reject) => {\n    this.request({\n      url: `https://${constant.OAUTH_DOMAIN}/token?grant_type=refresh_token&refresh_token=${refresh_token}`,\n      method: 'POST',\n      headers: {\n        'Authorization': 'Basic ' + base64Credentials,\n        'Content-Type': 'application/x-www-form-urlencoded',\n      }\n    }).then(response => {\n        this.setSession(response)\n        resolve()\n  }).catch(error => {\n        return reject(error);\n  })})\n}\n\nrequestToken(authorization_code) {\n  \n    let base64Credentials = Buffer.from(constant.OAUTH_CLIENT_ID+ ':' + 'optional').toString('base64');\n    return new Promise((resolve, reject) => {\n      this.request({\n        url: `https://${constant.OAUTH_DOMAIN}/token?grant_type=authorization_code&code=${authorization_code}`,\n        method: 'POST',\n        headers: {\n          'Authorization': 'Basic ' + base64Credentials,\n          'Content-Type': 'application/x-www-form-urlencoded',\n        }\n      }).then(response => {\n          this.setSession(response);\n          resolve(response)\n    }).catch(error => {\n          return reject(error);\n    })})\n  }\n\n  setSession(response) {\n    var access_token_payload = this.parseJwt(response.access_token);\n    var id_token_payload = this.parseJwt(response.id_token);\n\n    this.access_token = response.access_token;\n    this.expiresAt = access_token_payload.exp * 1000;\n    this.profile = { ...id_token_payload, 'name': `${id_token_payload.first_name} ${id_token_payload.last_name}` };\n\n    localStorage.setItem(constant.LOCALSTORAGE_ACCESS_TOKEN, response.access_token);\n    localStorage.setItem(constant.LOCALSTORAGE_REFRESH_TOKEN, response.refresh_token);\n    localStorage.setItem(constant.LOCALSTORAGE_ID_TOKEN, response.id_token);\n  }\n\n  signOut() {\n    //log out SSO\n    fetch(`https://${constant.OAUTH_DOMAIN}/logout`, {\n      method: 'GET'\n    });\n\n    localStorage.removeItem(constant.LOCALSTORAGE_ACCESS_TOKEN)\n    localStorage.removeItem(constant.LOCALSTORAGE_REFRESH_TOKEN)\n    localStorage.removeItem(constant.LOCALSTORAGE_ID_TOKEN)\n    this.expiresAt = 0\n    this.profile = undefined\n    \n  }\n\n  validateAuth() {\n    return new Promise((resolve, reject) => {\n      if(this.expiresAt && new Date().getTime() < this.expiresAt - 30*1000) { //30 seconds before it expires\n        resolve();\n      } else {\n        if(localStorage.getItem(constant.LOCALSTORAGE_REFRESH_TOKEN)){\n           this.refreshToken(localStorage.getItem(constant.LOCALSTORAGE_REFRESH_TOKEN)).then(response => {\n            console.log('refresh_token called successfully')\n            resolve();\n          }).catch(error => {\n            reject(error)\n          });\n        } else {\n          reject({error: 'login_required'})\n        }\n      }\n    });\n  }\n}\n\nconst auth0Client = new Auth();\n\nexport default auth0Client;\n"]},"metadata":{},"sourceType":"module"}